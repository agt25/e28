<!DOCTYPE html>

<html lang='en'>

    <head>

        <title>Stonks</title>
        <meta charset='utf-8'>
        <meta name="viewport" content="width=device-width">

        <link href="data:," rel="icon">
        <link href='style.css' rel='stylesheet'>

        <!-- Font Awesome -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
            rel="stylesheet"/>

        <!-- Google Fonts -->
        <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"/>

        <!-- MDB -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.3.0/mdb.min.css"
            rel="stylesheet"/>

        <!-- Bootstrap -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
            crossorigin="anonymous">

        <!-- Vue -->
        <script src='https://unpkg.com/vue@next' defer="defer"></script>

        <!-- Lodash -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.14.1/lodash.min.js">
        </script>

        <!-- Defered project script -->
        <script src='script.js' defer="defer"></script>
    </head>

    <body>

        <div id='app' v-cloak="v-cloak">

            <!-- Render on first load; Ask user for their name -->
            <div v-if='!userName' class='welcome-container'>
                <div class='welcome-item'>
                    <h2>Welcome</h2>
                    <h3>Please

                        <!-- CSS 'enter' key from CodePen -->
                        <span class="keyboard">
                            <span class="keyboard__row keyboard__row--h1">
                                <span class="key--bottom-right key--word key--w5" data-key="13">
                                    <span>enter</span>
                                </span>
                            </span>
                        </span>
                        your name....</h3>
                    <!-- Save the entered username as well as the user -->
                    <input
                        v-model.lazy.trim='userName'
                        placeholder='Your name...'
                        v-on:change="newUsers()"/>
                </div>
            </div>

            <!-- If user has inputted their name, render the game -->
            <div v-if='userName' class='game'>

                <!-- Header / Logo -->
                <header class='flex-jumbo'></header>

                <!-- Main Component of the Game -->
                <div class='stock-choices'>
                    <div class="container main-game">

                        <!-- If the computer won, tell the user they lost -->
                        <div v-if='gameOver'>
                            <div class='row justify-content-center text-center'>
                                <img id='game_over' src='images/game_over.svg'>
                                <p>Oh, no! The computer won :(</p>
                            </div>
                        </div>

                        <!-- If the user won, render winner message -->
                        <div v-else-if='userWins'>
                            <div class='row justify-content-center text-center'>
                                <img id='user_wins' src='images/winner.svg'>
                                <h6>Congrats!! You won the game!!</h6>
                                <p>You found all this wealth during a pandemic...<br>
                                    Some of us can't even find our phones :(</p>
                            </div>
                        </div>

                        <!-- Guide / How To Play button --> 
                        <div class='container'>
                            <div class='col-4 top-stats-item text-center'>
                                <button
                                    v-if='userName'
                                    v-on:click="guide = !guide"
                                    type="button"
                                    class="btn btn-warning"
                                    id="manualBtn">
                                    Guide
                                </button>
                            </div>

                            <!-- Show or hide guide directions when button is clicked --> 
                            <div v-if='guide' class='container frosted'>
                                <div class='row'>
                                    <div class="col-12" id="manualIntro">
                                        Find out how much you'd be worth today had you invested $10,000...<br>
                                        in a mystery stock back in 2009!
                                        <br>
                                    </div>
                                    <div class="col-12" id="instructions">
                                        <span id="howTo">How to Play</span>
                                        <br>
                                        1. When it's your turn, click on a mystery stock (briefcase)
                                        <br>
                                        2. Ta-da! You'll know just how much (or little!) you won or lost!<br>
                                        3. You'll also know how much your 2021 networth is<br>
                                        4. Allow the computer 4 seconds max to select a stock and play a round.<br>
                                        5. Whoever accumulates a networth of at least $3,000,000 first wins the game!
                                        <br>
                                        <br>
                                        PS, please do not select on behalf of the computer. 
                                        <br> Let's be nice and let the computer play for once. 
                                        They do so much for us :'(. 
                                    </div>
                                </div>
                            </div>


                            <div v-if='!gameOver && !userWins' class='top-stats-wrap'>

                                <!-- Highlight the active user currently playing --> 
                                <h3
                                    v-if='activePlayer'
                                    v-bind:value='playing'
                                    class='col-12 top-stats-item text-center'>
                                    {{ playing }}
                                </h3>
                            </div>

                               <!-- Show basic stats like current player and current round -->
                            <div v-if='!gameOver && !userWins' class='container'>
                                <div class='top-stats-wrap'>

                                    <!-- Active user's name --> 
                                    <h6
                                        v-if='activePlayer'
                                        v-bind:value='playing, activePlayer, gameRound'
                                        class='col-4 col-md-4 col-lg-4 top-stats-item text-center'>

                                        {{ activePlayer.name }}
                                        is playing...
                                    </h6>
                                    <!-- Current round number --> 
                                    <div
                                        v-bind:value='gameRound, activePlayer'
                                        class='col-4 col-md-4 col-lg-4 top-stats-item text-center'>
                                        Round #
                                        {{ gameRound }}
                                    </div>

                                </div>
                            </div>

                            <!-- Display six random mystery stocks at a time -->
                            <div v-if='!gameOver && !userWins' class="container">
                                <div class="row justify-content-center">
                                    <div
                                        v-for="stock in displayedStocks"
                                        v-bind:key="stock.id"
                                        class="col-6 col-md-4 col-lg-4 text-center stock">

                                        <!-- Stocks are displayed as clickable briefcases -->
                                        <button
                                            id="stockBtn"
                                            ref="submitStock"
                                            v-bind:value="stock.name"
                                            v-bind:key='stock.name'
                                            class="btn btn-default"
                                            v-on:click="stockReturn(stock), selectedStock = stock.name">
                                            <img id='case' src='/images/case.png' class='img-responsive'>
                                        </button>
                                    </div>
                                </div>
                            </div>


                            <!-- If user has selected a stock, show basic stats of the latest maneuver -->
                            <div class='container alerted'>
                                <div v-if='selected == true' class='alert text-center'>
                                    <span v-bind:class="{ won: won, lost: !won}">{{ displayMessage }}</span>
                                    <br>
                                    <div v-bind='displayPrevious'>
                                        <mark>
                                            {{ displayPrevious.player }}
                                        </mark>
                                        invested in
                                        {{ displayPrevious.stock }}
                                        <br>
                                        <span v-bind:class="{ won: won, lost: !won}">
                                            {{ displayPrevious.showChange }}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- If user has not yet selected a stock, guide them -->
                            <div v-if='!selected' class='col-12 text-center brief-instructions'>
                                Welcome!<br>
                                It's 2009.<br>
                                Select a mystery stock to invest $10,000 in.<br>
                                Find out how much you'll have made or lost today.<br>
                                The computer selects after you.<br>
                                Whoever accumulates a networth of $3,000,000 first wins the game!
                            </div>
                        </div>
                    </div>

                    <!-- Show each user's networth -->
                    <div v-if='gameStarted' class='stats-flex'>
                        <span v-bind:value='players' v-for='player in players' class='stats-item'>
                            {{ player.name }}
                            <span class='count-item networth'>
                                {{ formatPrice(player.networth) }}
                            </span>

                        </span>
                    </div>

                    <!-- Display wins and losses score card for each user -->
                    <div v-if='gameStarted' class='stats-flex'>
                        <span v-bind:value='players' v-for='player in players' class='stats-item'>
                            Stats

                            <div class='row justify-content-center'>
                                <span class='col-4 count-item win'>
                                    {{ player.won }}
                                </span>
                                <span class='col-4 count-item loss'>
                                    {{ player.lost }}
                                </span>
                            </div>
                        </span>
                    </div>

                    <!-- Display 'Game Log' and 'Reset' Buttons -->
                    <div class='container bottom-buttons'>

                        <!-- Button that 'Resets' the game -->
                        <div class='row justify-content-around bottom-buttons'>
                            <div class='col-6 text-center' id='resetBtn'>
                                <button class='text-center btn' v-on:click='resetGame' id='reset3'>
                                    <p v-if='!gameOver && !userWins'>Reset</p>
                                    <p v-else>Play Again</p>
                                </button>
                            </div>

                        </div>

                        <!-- Button for Game Logs component -->
                        <div class='row justify-content-around bottom-buttons'>
                            <div class='col-6 text-center' id='logBtn'>
                                <button v-if='userName' v-on:click="show = !show" class='btn btn-light'>
                                    Game Log
                                </button>
                            </div>
                        </div>

                    </div>

                    <!-- If button is clicked, show the game logs -->
                    <div v-if='show'>
                        <div id='history'>
                            <game-logs
                                v-for='round in rounds'
                                v-bind:round='round.round'
                                v-bind:player='round.player'
                                v-bind:result='round.result'
                                v-bind:change='round.showChange'
                                v-bind:stock='round.stock'
                                v-bind:networth='round.showNet'></game-logs>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Template for game-logs -->
<script id='game-logs' type='text/x-template'>
    <div>
        <ul class='logs text-center'>
            <li>
                Round #
                {{ round }}</li>
            <li>
                Player:
                {{ player }}
                {{ result }}
                {{ change }}
                by investing in
                {{ stock }}</li>

            <li>
                Networth:
                {{ networth }}
            </li>
        </ul>
    </div>
</script>


</body>
</html>